languages:
  ruby: 2.0.0-p353
setup:
- scripts:
  - export RAILS_ENV=test
  - echo "export RAILS_ENV=test" >> ~/.bash_profile
  # The next line happens in the PR for this repo
  - bundle install
  # The next line parses the Gemfile for crunchbase dependencies,
  # updates the repos on the box, and bundle installs for the latest
  # gem dependencies
  - for repo in `grep ":path => '/crunchbase/" Gemfile | cut -d ' ' -f 2 | sed -r "s/[',]//g"`; do cd /crunchbase/$repo && git pull && bundle install; done
test:
  machines: 1
  scripts:
  - tests:
      script: bundle exec rake ci_spec
      timeout: 1800
      xunit: spec/reports